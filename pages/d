import streamlit as st

# --- Step 1：定義初始菜單 ---
# 先從 session_state 抓 menu，否則用空清單
if "menu" not in st.session_state:
    st.session_state.menu = []

# --- Step 2：新增餐點功能 ---
text_input = st.text_input("🔤 新增餐點", placeholder="輸入餐點名稱")
if text_input:
    if text_input not in st.session_state.menu:
        st.session_state.menu.append(text_input)
        st.session_state[text_input] = 0
    else:
        st.warning("這道餐點已經加過囉！")

# --- Step 3：標題 ---
st.title("🍽️ 點餐機（加入 / 刪除 / 自訂菜單）")

# --- Step 4：清空點餐 ---
if st.button("🔁 清空點餐"):
    for item in st.session_state.menu:
        st.session_state[item] = 0
    st.rerun()

# --- Step 5：顯示菜單與按鈕 ---
for item in st.session_state.menu:
    col1, col2, col3 = st.columns([2, 1, 1])
    with col1:
        st.write(f"**{item}** x {st.session_state[item]}")
    with col2:
        if st.button("➕ 加入", key=f"add_{item}"):
            st.session_state[item] += 1
    with col3:
        if st.button("➖ 刪除", key=f"remove_{item}"):
            if st.session_state[item] > 0:
                st.session_state[item] -= 1

# --- Step 6：顯示購物清單 ---
st.write("---")
st.subheader("🛍️ 購物清單")

has_order = False
for item in st.session_state.menu:
    count = st.session_state[item]
    if count > 0:
        st.write(f"{item} x {count}")
        has_order = True

if not has_order:
    st.info("你還沒點任何東西喔～")
